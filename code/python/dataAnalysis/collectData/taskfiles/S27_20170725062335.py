#-*- coding: UTF-8 -*-



deviceModePointConfig=[
  {
    "StationType": 10,
    "DeviceModePointCode": "CV001",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WCNV_Hz",
    "DeviceModePointName": "电网频率",
    "CalcMethod": "Avg",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "CV001",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WCNV_Hz",
    "DeviceModePointName": "电网频率",
    "CalcMethod": "Max",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "CV001",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WCNV_Hz",
    "DeviceModePointName": "电网频率",
    "CalcMethod": "Min",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "CV001",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WCNV_Hz",
    "DeviceModePointName": "电网频率",
    "CalcMethod": "Std",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "GN001",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WGEN_Spd",
    "DeviceModePointName": "发电机转速",
    "CalcMethod": "Avg",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "GN001",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WGEN_Spd",
    "DeviceModePointName": "发电机转速",
    "CalcMethod": "Max",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "GN001",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WGEN_Spd",
    "DeviceModePointName": "发电机转速",
    "CalcMethod": "Min",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "GN001",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WGEN_Spd",
    "DeviceModePointName": "发电机转速",
    "CalcMethod": "Std",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "NC001",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WNAC_WdSpd",
    "DeviceModePointName": "机舱外风速实时值",
    "CalcMethod": "Avg",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "NC001",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WNAC_WdSpd",
    "DeviceModePointName": "机舱外风速实时值",
    "CalcMethod": "Max",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "NC001",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WNAC_WdSpd",
    "DeviceModePointName": "机舱外风速实时值",
    "CalcMethod": "Min",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "NC001",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WNAC_WdSpd",
    "DeviceModePointName": "机舱外风速实时值",
    "CalcMethod": "Std",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "NC004",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WNAC_ExTmp",
    "DeviceModePointName": "机舱外环境温度",
    "CalcMethod": "Avg",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "NC004",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WNAC_ExTmp",
    "DeviceModePointName": "机舱外环境温度",
    "CalcMethod": "Max",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "NC004",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WNAC_ExTmp",
    "DeviceModePointName": "机舱外环境温度",
    "CalcMethod": "Min",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "NC004",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WNAC_ExTmp",
    "DeviceModePointName": "机舱外环境温度",
    "CalcMethod": "Std",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "NC005",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WNAC_IntlTmp",
    "DeviceModePointName": "机舱内温度",
    "CalcMethod": "Avg",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "NC005",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WNAC_IntlTmp",
    "DeviceModePointName": "机舱内温度",
    "CalcMethod": "Max",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "NC005",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WNAC_IntlTmp",
    "DeviceModePointName": "机舱内温度",
    "CalcMethod": "Min",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "NC005",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WNAC_IntlTmp",
    "DeviceModePointName": "机舱内温度",
    "CalcMethod": "Std",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "RT001",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WROT_RotSpd",
    "DeviceModePointName": "轮毂转速",
    "CalcMethod": "Avg",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "RT001",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WROT_RotSpd",
    "DeviceModePointName": "轮毂转速",
    "CalcMethod": "Max",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "RT001",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WROT_RotSpd",
    "DeviceModePointName": "轮毂转速",
    "CalcMethod": "Min",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "RT001",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WROT_RotSpd",
    "DeviceModePointName": "轮毂转速",
    "CalcMethod": "Std",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "RT005",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WROT_PtAngValBl1",
    "DeviceModePointName": "桨叶1角度",
    "CalcMethod": "Avg",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "RT005",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WROT_PtAngValBl1",
    "DeviceModePointName": "桨叶1角度",
    "CalcMethod": "Max",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "RT005",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WROT_PtAngValBl1",
    "DeviceModePointName": "桨叶1角度",
    "CalcMethod": "Min",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "RT005",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WROT_PtAngValBl1",
    "DeviceModePointName": "桨叶1角度",
    "CalcMethod": "Std",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "TR002",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WTUR_W",
    "DeviceModePointName": "有功功率",
    "CalcMethod": "Avg",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "TR002",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WTUR_W",
    "DeviceModePointName": "有功功率",
    "CalcMethod": "Max",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "TR002",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WTUR_W",
    "DeviceModePointName": "有功功率",
    "CalcMethod": "Min",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "TR002",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WTUR_W",
    "DeviceModePointName": "有功功率",
    "CalcMethod": "Std",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "TR003",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WTUR_Var",
    "DeviceModePointName": "无功功率",
    "CalcMethod": "Avg",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "TR003",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WTUR_Var",
    "DeviceModePointName": "无功功率",
    "CalcMethod": "Max",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "TR003",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WTUR_Var",
    "DeviceModePointName": "无功功率",
    "CalcMethod": "Min",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "TR003",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WTUR_Var",
    "DeviceModePointName": "无功功率",
    "CalcMethod": "Std",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "TR005",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WTUR_WLimDmd",
    "DeviceModePointName": "有功功率限定状态",
    "CalcMethod": "Avg",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "TR005",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WTUR_WLimDmd",
    "DeviceModePointName": "有功功率限定状态",
    "CalcMethod": "Max",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "TR005",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WTUR_WLimDmd",
    "DeviceModePointName": "有功功率限定状态",
    "CalcMethod": "Min",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "TR005",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WTUR_WLimDmd",
    "DeviceModePointName": "有功功率限定状态",
    "CalcMethod": "Std",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "TR008",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WTUR_TotWh",
    "DeviceModePointName": "总有功发电量",
    "CalcMethod": "Last",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "TR008",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WTUR_TotWh",
    "DeviceModePointName": "总有功发电量",
    "CalcMethod": "First",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "TR008",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WTUR_TotWh",
    "DeviceModePointName": "总有功发电量",
    "CalcMethod": "Dif",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "TR012",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WTUR_TotWhDly",
    "DeviceModePointName": "日发电量总计",
    "CalcMethod": "Last",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "TR012",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WTUR_TotWhDly",
    "DeviceModePointName": "日发电量总计",
    "CalcMethod": "First",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "TR012",
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WTUR_TotWhDly",
    "DeviceModePointName": "日发电量总计",
    "CalcMethod": "Dif",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "FM001",
    "DeviceTypeCode": 801,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WFRM_WdSpdAv",
    "DeviceModePointName": "全场平均风速",
    "CalcMethod": "Avg",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "FM001",
    "DeviceTypeCode": 801,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WFRM_WdSpdAv",
    "DeviceModePointName": "全场平均风速",
    "CalcMethod": "Max",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "FM001",
    "DeviceTypeCode": 801,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WFRM_WdSpdAv",
    "DeviceModePointName": "全场平均风速",
    "CalcMethod": "Min",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "FM001",
    "DeviceTypeCode": 801,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WFRM_WdSpdAv",
    "DeviceModePointName": "全场平均风速",
    "CalcMethod": "Std",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "FM005",
    "DeviceTypeCode": 801,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WFRM_TotW",
    "DeviceModePointName": "总发出有功电量",
    "CalcMethod": "Avg",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "FM005",
    "DeviceTypeCode": 801,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WFRM_TotW",
    "DeviceModePointName": "总发出有功电量",
    "CalcMethod": "Max",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "FM005",
    "DeviceTypeCode": 801,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WFRM_TotW",
    "DeviceModePointName": "总发出有功电量",
    "CalcMethod": "Min",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "FM005",
    "DeviceTypeCode": 801,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WFRM_TotW",
    "DeviceModePointName": "总发出有功电量",
    "CalcMethod": "Std",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "FM002",
    "DeviceTypeCode": 801,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WFRM_TotWhDly",
    "DeviceModePointName": "日累计电量",
    "CalcMethod": "Last",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "FM002",
    "DeviceTypeCode": 801,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WFRM_TotWhDly",
    "DeviceModePointName": "日累计电量",
    "CalcMethod": "First",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "FM002",
    "DeviceTypeCode": 801,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WFRM_TotWhDly",
    "DeviceModePointName": "日累计电量",
    "CalcMethod": "Dif",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "FM003",
    "DeviceTypeCode": 801,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WFRM_TotWhMly",
    "DeviceModePointName": "月累计电量",
    "CalcMethod": "Last",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "FM003",
    "DeviceTypeCode": 801,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WFRM_TotWhMly",
    "DeviceModePointName": "月累计电量",
    "CalcMethod": "First",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "FM003",
    "DeviceTypeCode": 801,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WFRM_TotWhMly",
    "DeviceModePointName": "月累计电量",
    "CalcMethod": "Dif",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "FM004",
    "DeviceTypeCode": 801,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WFRM_TotWhYly",
    "DeviceModePointName": "年累计电量",
    "CalcMethod": "Last",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "FM004",
    "DeviceTypeCode": 801,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WFRM_TotWhYly",
    "DeviceModePointName": "年累计电量",
    "CalcMethod": "First",
    "Divation": 600
  },
  {
    "StationType": 10,
    "DeviceModePointCode": "FM004",
    "DeviceTypeCode": 801,
    "DeviceModeCode": 1,
    "DeviceModePointIECName": "WFRM_TotWhYly",
    "DeviceModePointName": "年累计电量",
    "CalcMethod": "Dif",
    "Divation": 600
  }
]

allDevice=[
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 1,
    "DeviceFullCode": "27M101M1M1",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M1",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 2,
    "DeviceFullCode": "27M101M1M2",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M1",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 3,
    "DeviceFullCode": "27M101M1M3",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M1",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 4,
    "DeviceFullCode": "27M101M1M4",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M1",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 5,
    "DeviceFullCode": "27M101M1M5",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M1",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 6,
    "DeviceFullCode": "27M101M1M6",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M1",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 7,
    "DeviceFullCode": "27M101M1M7",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M1",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 8,
    "DeviceFullCode": "27M101M1M8",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M1",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 9,
    "DeviceFullCode": "27M101M1M9",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M1",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 10,
    "DeviceFullCode": "27M101M1M10",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M1",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 11,
    "DeviceFullCode": "27M101M1M11",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M1",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 12,
    "DeviceFullCode": "27M101M1M12",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M2",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 13,
    "DeviceFullCode": "27M101M1M13",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M2",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 14,
    "DeviceFullCode": "27M101M1M14",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M2",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 15,
    "DeviceFullCode": "27M101M1M15",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M2",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 16,
    "DeviceFullCode": "27M101M1M16",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M2",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 17,
    "DeviceFullCode": "27M101M1M17",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M2",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 18,
    "DeviceFullCode": "27M101M1M18",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M3",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 19,
    "DeviceFullCode": "27M101M1M19",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M3",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 20,
    "DeviceFullCode": "27M101M1M20",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M3",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 21,
    "DeviceFullCode": "27M101M1M21",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M3",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 22,
    "DeviceFullCode": "27M101M1M22",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M3",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 23,
    "DeviceFullCode": "27M101M1M23",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M3",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 24,
    "DeviceFullCode": "27M101M1M24",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M2",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 25,
    "DeviceFullCode": "27M101M1M25",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M2",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 26,
    "DeviceFullCode": "27M101M1M26",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M2",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 27,
    "DeviceFullCode": "27M101M1M27",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M2",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 28,
    "DeviceFullCode": "27M101M1M28",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M2",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 29,
    "DeviceFullCode": "27M101M1M29",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M3",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 30,
    "DeviceFullCode": "27M101M1M30",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M3",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 31,
    "DeviceFullCode": "27M101M1M31",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M3",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 32,
    "DeviceFullCode": "27M101M1M32",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M3",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 101,
    "DeviceModeCode": 1,
    "DeviceCode": 33,
    "DeviceFullCode": "27M101M1M33",
    "DeviceModeFullCode": "27M101M1",
    "PDeviceFullCode": "27M302M2M3",
    "Capacity": None
  },
  {
    "DeviceTypeCode": 302,
    "DeviceModeCode": 2,
    "DeviceCode": 1,
    "DeviceFullCode": "27M302M2M1",
    "DeviceModeFullCode": "27M302M2",
    "PDeviceFullCode": None,
    "Capacity": None
  },
  {
    "DeviceTypeCode": 302,
    "DeviceModeCode": 2,
    "DeviceCode": 2,
    "DeviceFullCode": "27M302M2M2",
    "DeviceModeFullCode": "27M302M2",
    "PDeviceFullCode": None,
    "Capacity": None
  },
  {
    "DeviceTypeCode": 302,
    "DeviceModeCode": 2,
    "DeviceCode": 3,
    "DeviceFullCode": "27M302M2M3",
    "DeviceModeFullCode": "27M302M2",
    "PDeviceFullCode": None,
    "Capacity": None
  },
  {
    "DeviceTypeCode": 307,
    "DeviceModeCode": 3,
    "DeviceCode": 1,
    "DeviceFullCode": "27M307M3M1",
    "DeviceModeFullCode": "27M307M3",
    "PDeviceFullCode": None,
    "Capacity": None
  },
  {
    "DeviceTypeCode": 505,
    "DeviceModeCode": 4,
    "DeviceCode": 1,
    "DeviceFullCode": "27M505M4M1",
    "DeviceModeFullCode": "27M505M4",
    "PDeviceFullCode": None,
    "Capacity": None
  },
  {
    "DeviceTypeCode": 505,
    "DeviceModeCode": 4,
    "DeviceCode": 2,
    "DeviceFullCode": "27M505M4M2",
    "DeviceModeFullCode": "27M505M4",
    "PDeviceFullCode": None,
    "Capacity": None
  },
  {
    "DeviceTypeCode": 801,
    "DeviceModeCode": 1,
    "DeviceCode": 1,
    "DeviceFullCode": "27M801M1M1",
    "DeviceModeFullCode": "27M801M1",
    "PDeviceFullCode": None,
    "Capacity": None
  }
]

class pyScriptTemplate_101:
    def __init__(self, StationCode, PT_azuretable, PT_sql, DataBeginTime, DataEndTime):
        self.sDt = parser.parse(DataBeginTime)
        eDt = parser.parse(DataEndTime)
        self.sTime=self.sDt.strftime("%Y-%m-%d %H:%M:%S")
        self.time_width = PT_sql * 60
        self.sRowKey = mathtool.TimetoStamp(self.sDt)
        self.eRowKey = mathtool.TimetoStamp(eDt)
        self.stationCode=StationCode
        self.table_WdDir = 'S' + str(StationCode) + 'M101PT' + str(PT_sql) + 'M' + '_WdDir'
        self.table_WdSpdZon = 'S' + str(StationCode) + 'M101PT' + str(PT_sql) + 'M' + '_WdSpdZon'
        self.table_TurIECSt = 'S' + str(StationCode) + 'M101PT' + str(PT_sql) + 'M' + '_IECSt'
        self.azureTableNameSuffix = 'T' + self.sDt.strftime('%Y%m') + 'PT' + str(PT_azuretable) + 'S'
        self.table_service = TableService(account_name=tc.account_name, account_key=tc.account_key,endpoint_suffix=tc.endpoint_suffix) 
        self.q = []
        self.azureTableRow = 0

        # 去除None值后转化为float类型

    def RemoveNoneandtoFloat(self, value):
        return np.array([float(w) for w in [str(v) for v in list(value) if
                                            str(v) != 'None' and str(v) != '' and len(str(v).split(',')) <= 1]])

    # 去除None值后转化为List
    def RemoveNoneandtoList(self, value):
        return np.array([w for w in [str(v).replace('[', '').replace(']', '') for v in list(value) if
                                     str(v) != 'None' and str(v) != '' and len(list(v)) >= 1]])

    def ___calcWindTurbineToSql(self):
        allDeviceTypeDevice = filter(lambda x: x['DeviceTypeCode'] == 101, allDevice)
        for deviceItem in allDeviceTypeDevice:
            try:
               df = self.___readAzureTableToDF(deviceItem)
               point_item = filter(
                   lambda x: x['DeviceTypeCode'] == deviceItem['DeviceTypeCode'] and x['DeviceModeCode'] == deviceItem[
                       'DeviceModeCode'], deviceModePointConfig)
               data = self.___calcAggrega(df, point_item, deviceItem['DeviceTypeCode'], deviceItem['DeviceModeFullCode'],
                                          deviceItem['DeviceFullCode'])
               deviceCode = deviceItem['DeviceFullCode']
               self.___calcTurIECSt(df, deviceCode)
               self.___calcWdDir(df, deviceCode)
               self.___calcWdSpdZon(df, deviceCode)
            except BaseException as err:
               pass 
        pass

    def ___calcWdSpdZon(self, entities, DeviceCode):
        if 'NC013'  in  entities.columns :
           sTime=self.sTime
           WNAC_WdSpdZon = entities["NC013"]#[:, self.DeviceModePointIECName.index('WNAC_WdSpdZon')]
           WNAC_WdSpdZon = WNAC_WdSpdZon[np.argsort(WNAC_WdSpdZon)]
           WNAC_WdSpdZonID = []
           for v in WNAC_WdSpdZon:
               if not v in WNAC_WdSpdZonID:
                   WNAC_WdSpdZonID.append(v)
           
                   # 遍历所有WNAC_WdSpdZonID
           for id in WNAC_WdSpdZonID:
               count = 0
               for i in WNAC_WdSpdZon:
                   if i == id:
                       count = count + 1
               if count > 0:
                   sql = 'DELETE from dbo.' + self.table_WdSpdZon + ' where DeviceCode=' + '\'' + DeviceCode + '\'' + ' and TimeStamp=' + '\'' + sTime + '\'' + ' and WNAC_WdSpdZon=' + str(
                       id) + '  \
		   				insert into dbo.' + self.table_WdSpdZon + '(DeviceCode,TimeStamp,WNAC_WdSpdZon,count) \
		   				values(' + '\'' + DeviceCode + '\'' + ',' + '\'' + sTime + '\'' + ',' + str(id) + ',' + str(
                       count) + ') '
                   # print(sql)
                   # ms.ExecNonQuery(sql)
                   self.q.append(sql)

    def ___calcWdDir(self, entities, DeviceCode):
        if 'NC014'  in  entities.columns  and 'NC001'  in  entities.columns  and 'TR002'  in  entities.columns:
           sTime=self.sTime
           # 总共16个风向区间
           for dir in range(1, 17):
               # 根据风向区间找到对应风速和功率
               WNAC_WdSpd = self.DFFindPos(dir, entities, 'NC014',
                                             'NC001')
               WTUR_W = self.DFFindPos(dir, entities,'NC014',
                                        'TR002')
               # 风向dir存在则写入
               if WNAC_WdSpd:
                   WNAC_WdSpdnp = np.array(WNAC_WdSpd).astype(np.float)
                   WNAC_WdSpd_Avg = mathtool.Mean(WNAC_WdSpdnp)
                   WTUR_Wnp = np.array(WNAC_WdSpd).astype(np.float)
                   WTUR_W_Avg = mathtool.Mean(WTUR_Wnp)
                   sql = 'DELETE from dbo.' + self.table_WdDir + ' where DeviceCode=' + '\'' + DeviceCode + '\'' + ' and TimeStamp=' + '\'' + sTime + '\'' + ' and WNAC_WdDirZon=' + str(
                       dir) + '  \
		   			insert into dbo.' + self.table_WdDir + '(DeviceCode,TimeStamp,WNAC_WdDirZon,WNAC_WdSpd_Avg,WTUR_W_Avg,count) \
		   			values(' + '\'' + DeviceCode + '\'' + ',' + '\'' + sTime + '\'' + ',' + str(dir) + ',' + str(
                       WNAC_WdSpd_Avg) + ',' + str(WTUR_W_Avg) + ',' + str(len(WNAC_WdSpd)) + ') '
                   # ms.ExecNonQuery(sql)
                   self.q.append(sql)

    def ___calcTurIECSt(self, df, DeviceCode):
        if 'TR015'  in  df.columns:
           sTime=self.sTime
           entities=df["TR015"]
           
           # 总共14个状态
           for iec in range(1, 15):
               count = 0
               for j in range(len(entities)):
                   if int(entities[j]) == int(iec):
                       count = count + 1
           
               # WTUR_TurIECSt存在则写入
               if count > 0:
                   sql = 'DELETE from dbo.' + self.table_TurIECSt + ' where DeviceCode=' + '\'' + DeviceCode + '\'' + ' and TimeStamp=' + '\'' + sTime + '\'' + ' and WTUR_TurIECSt = ' + str(
                       iec) + '\
		   					insert into dbo.' + self.table_TurIECSt + '(DeviceCode,TimeStamp,WTUR_TurIECSt,count) \
		   					values(' + '\'' + DeviceCode + '\'' + ',' + '\'' + sTime + '\'' + ',' + str(
                       iec) + ',' + str(count) + ') '
                   self.q.append(sql)

    def ___calcAggrega(self, df, pointConfig, DeviceTypeCode, DeviceModeCode, DeviceCode):

        # DeviceCode = DeviceModeCode + 'M' + str(DeviceCode)

        ##聚合计算
        data = newMathUtility.calcAggrega(df, pointConfig)
        newDBData = {}
        for dbc in data:
            if data[dbc] != None:
                newDBData[dbc] = data[dbc]
        colum = list(newDBData.keys())
        # (lm)添加len(colum) > 0
        if len(colum) > 0:
            value = [newDBData[v] for v in colum]
            count = len(df)
            tablename_Aggrega = 'S' + str(self.stationCode) + 'M' + str(DeviceTypeCode) + 'PT10M_Aggrega'
            sql = 'delete from dbo.' + tablename_Aggrega + ' where DeviceCode=' + '\'' + DeviceCode + '\'' + ' and TimeStamp=' + '\'' + self.sTime + '\'' + ' \
			  insert into dbo.' + tablename_Aggrega + '(DeviceCode,TimeStamp,count,' + str(colum).replace('[',
                                                                                                          '').replace(
                ']', '').replace('\'', '') + ') \
			  values (' + '\'' + DeviceCode + '\'' + ',' + '\'' + self.sTime + '\'' + ',' + str(count) + ',' + str(
                value).replace('[', '').replace(']', '') + ') '
            self.q.append(sql)

        return newDBData

    def ___calcDeviceAggrega(self, deviceTypeCode):
        allDeviceTypeDevice = filter(lambda x: x['DeviceTypeCode'] == deviceTypeCode, allDevice)
        for deviceItem in allDeviceTypeDevice:
            df = self.___readAzureTableToDF(deviceItem)
            point_item = filter(
                lambda x: x['DeviceTypeCode'] == deviceItem['DeviceTypeCode'] and x['DeviceModeCode'] == deviceItem[
                    'DeviceModeCode'], deviceModePointConfig)
            data = self.___calcAggrega(df, point_item, deviceItem['DeviceTypeCode'], deviceItem['DeviceModeFullCode'],
                                       deviceItem['DeviceFullCode'])
        pass

    def ___readAzureTableToDF(self, device):

        deviceCode = device.get('DeviceCode')
        deviceModeCode = device.get('DeviceModeFullCode')
        devicetypeCode = device.get('DeviceTypeCode')
        if (deviceCode is not None or deviceModeCode is not None and devicetypeCode is not None):
            # print(str(deviceCode)+',')
            filter_string = 'PartitionKey eq ' + '\'' + str(deviceCode) + '\'' + ' and RowKey ge ' + '\'' + str(
                self.sRowKey) + '\'' + ' and RowKey le ' + '\'' + str(self.eRowKey) + '\''
            tasks = self.table_service.query_entities('S' + str(deviceModeCode) + self.azureTableNameSuffix,
                                                      filter_string)
            rows_list = []
            for item in tasks:
                rows_list.append(item)

            df = pd.DataFrame(rows_list)
            self.azureTableRow = self.azureTableRow + len(df)
            return df

        return None

    def DFFindPos(self,value,entity,list_i,list_j):
        try: 
            pos=[]
            for v in range(0,len(entity)): 
                if value==entity[list_i][v]: 
                    pos.append(entity[list_j][v])
            return pos 
        except: 
            return NULL

    def execute(self):
        self.___calcWindTurbineToSql()
        self.___calcDeviceAggrega(801)
        allsql = '\n'.join(self.q)
        ms = msconn.MSSQL(host=tc.mssqlConn_host, user=tc.mssqlConn_user, pwd=tc.mssqlConn_pwd, db=tc.mssqlConn_dbname)
        ms.ExecNonQuery(allsql)
        jsonStr = {"tableRow": self.azureTableRow, "sqlRow": len(self.q)}
        return jsonStr


'''
获取taskparam，执行task
'''


def run(taskparam):
    DataBeginTime = taskparam['DataBeginTime']
    DataEndTime = taskparam['DataEndTime']
    # print(DataBeginTime)
    result = {}
    # info = ReadWrite(DataBeginTime,DataEndTime).CalTable(table_WdDir = True, table_WdSpdZon = True, table_TurIECSt = True, table_Aggrega = True, table_Day = True)
    try:

        pyScript = pyScriptTemplate_101(27,5, 10, DataBeginTime, DataEndTime)
        jsonResult = pyScript.execute()

        result["Status"] = 400
        result["info"] = "success"
        result["tableRow"] = jsonResult["tableRow"]
        result["sqlRow"] = jsonResult["sqlRow"]



    except BaseException as err:
        result["Status"] = 404
        result["tableRow"] = 0
        result["sqlRow"] = 0
        result["info"] = str(err)

    return result
